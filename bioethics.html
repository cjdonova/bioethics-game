<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Bioethics Scenario Game</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 2em; }
    .option { display: block; margin: 1em 0; padding: 1em; border: 1px solid #ccc; border-radius: 6px; background: #f9f9f9; cursor: pointer; }
    .option.disabled { color: #aaa; background: #eee; cursor: not-allowed; }
    .consequence { margin: 1.5em 0; font-style: italic; }
    .step { font-weight: bold; margin-top: 1em; }
    .restart { margin-top: 2em; display: block; }
  </style>
</head>
<body>
  <h1>Bioethics Scenario</h1>
  <div id="game"></div>
  <script>
    // Scenario Data
    const scenario = [
      {
        question: "You are a doctor faced with a patient who refuses a life-saving blood transfusion for religious reasons. What do you do?",
        options: [
          { text: "Respect the patient's wishes and do not administer the transfusion.", consequence: "The patient's autonomy is respected, but their life is at risk." },
          { text: "Administer the transfusion despite their refusal.", consequence: "You save the patient, but violate their autonomy and potentially their trust." },
          { text: "Seek a court order to determine the appropriate action.", consequence: "The legal system intervenes, possibly delaying treatment." }
        ]
      },
      {
        question: "The patient's family arrives and begs you to save their loved one, regardless of their previously stated wishes. What do you do?",
        options: [
          { text: "Explain the patient's wishes and refuse the family's request.", consequence: "You uphold the patient's autonomy but create distress for the family." },
          { text: "Give in to the family's wishes.", consequence: "You override the patient's autonomy in favor of family wishes." },
          { text: "Seek an ethics consultation.", consequence: "An ethics team is brought in, which may help mediate the situation." }
        ]
      },
      {
        question: "After the event, the hospital asks you to reflect on your actions for future policy. What do you recommend?",
        options: [
          { text: "Always respect patient autonomy above all.", consequence: "Policies may become stricter in favor of autonomy." },
          { text: "Consider family wishes in extreme cases.", consequence: "Policies may become more flexible but risk undermining autonomy." },
          { text: "Always seek legal or ethical counsel in such dilemmas.", consequence: "Policies may become more bureaucratic but thorough." }
        ]
      }
    ];

    let step = 0;
    let locked = false;

    function renderStep() {
      const gameDiv = document.getElementById('game');
      gameDiv.innerHTML = '';
      if (step < scenario.length) {
        const stepData = scenario[step];
        const stepElem = document.createElement('div');
        stepElem.className = "step";
        stepElem.textContent = `Step ${step + 1}`;
        gameDiv.appendChild(stepElem);

        const question = document.createElement('div');
        question.textContent = stepData.question;
        gameDiv.appendChild(question);

        stepData.options.forEach((option, i) => {
          const btn = document.createElement('button');
          btn.className = 'option';
          btn.textContent = option.text;
          btn.onclick = () => {
            if (!locked) handleChoice(i);
          };
          if (locked) btn.classList.add('disabled');
          gameDiv.appendChild(btn);
        });

        if (locked && stepData.lastConsequence) {
          const cons = document.createElement('div');
          cons.className = 'consequence';
          cons.textContent = stepData.lastConsequence;
          gameDiv.appendChild(cons);

          const nextBtn = document.createElement('button');
          nextBtn.textContent = step < scenario.length - 1 ? "Next Step" : "Finish";
          nextBtn.onclick = () => {
            step++;
            locked = false;
            renderStep();
          };
          gameDiv.appendChild(nextBtn);
        }
      } else {
        const end = document.createElement('div');
        end.innerHTML = "<strong>You have completed the scenario!</strong>";
        gameDiv.appendChild(end);
        const restart = document.createElement('button');
        restart.className = "restart";
        restart.textContent = "Restart";
        restart.onclick = () => {
          step = 0;
          locked = false;
          scenario.forEach(s => delete s.lastConsequence);
          renderStep();
        };
        gameDiv.appendChild(restart);
      }
    }

    function handleChoice(optionIndex) {
      locked = true;
      const stepData = scenario[step];
      stepData.lastConsequence = stepData.options[optionIndex].consequence;
      renderStep();
    }

    renderStep();
  </script>
</body>
</html>
