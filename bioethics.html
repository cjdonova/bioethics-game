<!DOCTYPE html>
<html>
<head>
    <title>BioEthics 4-Step Adventure</title>
    <style>
        body { font-family: Arial, sans-serif; background: #f0f8ff; padding: 20px; max-width: 900px; margin: 0 auto; }
        .container { background: white; padding: 30px; border-radius: 10px; box-shadow: 0 4px 20px rgba(0,0,0,0.1); }
        h1 { color: #2c3e50; text-align: center; font-size: 2.5em; margin-bottom: 10px; }
        .subtitle { text-align: center; color: #7f8c8d; font-size: 1.2em; margin-bottom: 30px; }
        .step-info { text-align: center; margin: 20px 0; padding: 15px; background: #e8f6ff; border-radius: 8px; border-left: 4px solid #3498db; }
        .scenario { background: #f8f9fa; padding: 25px; border-radius: 10px; margin: 20px 0; border-left: 5px solid #27ae60; }
        .consequence { padding: 20px; margin: 20px 0; border-radius: 8px; display: none; border-left: 4px solid; }
        .consequence.positive { background: #d4edda; border-color: #28a745; color: #155724; }
        .consequence.negative { background: #f8d7da; border-color: #dc3545; color: #721c24; }
        .consequence.mixed { background: #fff3cd; border-color: #ffc107; color: #856404; }
        .thinking-box { background: #f1f3f4; padding: 20px; border-radius: 8px; margin: 20px 0; }
        .thinking-box textarea { width: 100%; height: 80px; padding: 10px; border: 2px solid #ddd; border-radius: 5px; font-family: inherit; box-sizing: border-box; }
        .choices { margin: 20px 0; }
        .choice { margin: 10px 0; }
        .choice button { width: 100%; padding: 15px 20px; background: linear-gradient(135deg, #3498db, #2980b9); color: white; border: none; border-radius: 8px; font-size: 16px; cursor: pointer; text-align: left; transition: all 0.3s ease; }
        .choice button:hover { background: linear-gradient(135deg, #2980b9, #1f4e79); transform: translateY(-2px); box-shadow: 0 4px 15px rgba(0,0,0,0.2); }
        .choice button:disabled { background: #95a5a6; cursor: not-allowed; transform: none; }
        .score-display { position: fixed; top: 20px; right: 20px; background: rgba(44, 62, 80, 0.9); color: white; padding: 15px; border-radius: 10px; font-weight: bold; z-index: 1000; }
        .path-display { background: #e8f4fd; padding: 15px; border-radius: 8px; margin: 20px 0; border-left: 4px solid #3498db; }
        .results { text-align: center; padding: 30px; background: #f8f9fa; border-radius: 10px; margin: 20px 0; }
        .final-score { font-size: 3em; color: #3498db; margin: 20px 0; }
        .restart-btn { background: linear-gradient(135deg, #27ae60, #219a52); color: white; border: none; padding: 15px 30px; border-radius: 8px; font-size: 16px; cursor: pointer; margin-top: 20px; }
        .hidden { display: none; }
    </style>
</head>
<body>
    <div class="container">
        <!-- Start Screen -->
        <div id="start-screen">
            <h1>üß¨ BioEthics 4-Step Adventure</h1>
            <p class="subtitle">Navigate 4 detailed steps for each ethical path you choose</p>
            
            <div style="background: #e8f6ff; padding: 20px; border-radius: 10px; margin: 20px 0;">
                <h3>üåä How It Works:</h3>
                <ul style="text-align: left; max-width: 600px; margin: 0 auto;">
                    <li><strong>Choose Your Scenario:</strong> Genetic Test, AI Diagnostics, or Gene Therapy</li>
                    <li><strong>4 Steps Deep:</strong> Each scenario has 4 detailed dilemmas with consequences</li>
                    <li><strong>Real Complications:</strong> Funding, equity, legal, and media challenges</li>
                    <li><strong>Track Your Reasoning:</strong> Record your thinking at each step</li>
                </ul>
            </div>
            
            <button id="start-btn" style="background: linear-gradient(135deg, #3498db, #2980b9); color: white; border: none; padding: 20px 40px; border-radius: 10px; font-size: 18px; cursor: pointer; margin-top: 20px;">
                üöÄ Begin 4-Step Journey
            </button>
        </div>

        <!-- Game Screen -->
        <div id="game-screen" class="hidden">
            <div class="score-display">
                Ethics Score: <span id="score">100</span>/100
            </div>

            <div class="step-info">
                <strong>Step <span id="current-step">1</span> of 4</strong> - 
                <span id="scenario-name">Scenario</span>
            </div>

            <div class="path-display" id="path-display" style="display: none;">
                <strong>Your Scenario:</strong> <span id="current-path">Starting Point</span>
            </div>

            <div class="scenario" id="scenario-text"></div>

            <div class="consequence" id="consequence"></div>

            <div class="thinking-box">
                <label><strong>üí≠ Your Strategic Thinking:</strong></label>
                <textarea id="thinking" placeholder="What factors are you considering? What ethical principles are at stake?"></textarea>
            </div>

            <div class="choices" id="choices"></div>
        </div>

        <!-- Results Screen -->
        <div id="results-screen" class="hidden">
            <div class="results">
                <h2>üéØ Your 4-Step Journey Complete</h2>
                <div class="final-score" id="final-score">100</div>
                <div id="assessment"></div>
                
                <div style="text-align: left; margin-top: 30px;">
                    <h3>üõ§Ô∏è Your Complete Path:</h3>
                    <div id="decision-summary"></div>
                    
                    <h3 style="margin-top: 30px;">üß† Your Reasoning:</h3>
                    <div id="thinking-summary"></div>
                </div>

                <button class="restart-btn" onclick="restartGame()">üîÑ Try Different Scenario</button>
            </div>
        </div>
    </div>

    <script>
        var gameData = {
            currentStep: 1,
            score: 100,
            decisions: [],
            thoughts: [],
            chosenPath: null,
            pathName: ''
        };

        // Scenario Data (your updated 3 scenarios!)
        var allScenarios = {
            genetic: [
                {
                    name: "Genetic Test ‚Äì Funding Dilemma",
                    text: "üèÅ You‚Äôve developed a low-cost genetic test to detect early-stage cancer. What do you do?",
                    choices: [
                        { text: "Seek private funding for immediate rollout", points: 5 },
                        { text: "Apply for government grants", points: 10 }
                    ]
                },
                {
                    name: "Genetic Test ‚Äì Price Pressure",
                    text: "Private funders demand exclusivity and a high list price. What do you do?",
                    choices: [
                        { text: "Accept their terms", points: -5 },
                        { text: "Push back for affordability", points: 10 }
                    ]
                },
                {
                    name: "Genetic Test ‚Äì Pilot Program Offer",
                    text: "A national hospital chain offers an exclusive pilot. What do you do?",
                    choices: [
                        { text: "Accept and test in affluent cities", points: 5 },
                        { text: "Propose diverse, lower-income test sites", points: 10 }
                    ]
                },
                {
                    name: "Genetic Test ‚Äì Pricing the Test",
                    text: "FDA approval is near. You're asked to price the test. What do you do?",
                    choices: [
                        { text: "Price high to satisfy backers", points: -5 },
                        { text: "Implement tiered pricing", points: 10 }
                    ]
                }
            ],
            ai: [
                {
                    name: "AI Diagnostics ‚Äì Release Decision",
                    text: "üèÅ You‚Äôve created an AI model that accurately predicts stroke risk. What do you do?",
                    choices: [
                        { text: "Publish the algorithm open-source", points: 10 },
                        { text: "Patent and sell to insurers", points: 5 }
                    ]
                },
                {
                    name: "AI Diagnostics ‚Äì Insurance Offer",
                    text: "A major insurer offers to buy it‚Äîbut will use it only for premium clients. What do you do?",
                    choices: [
                        { text: "Accept deal", points: 5 },
                        { text: "Propose a universal license clause", points: 10 }
                    ]
                },
                {
                    name: "AI Diagnostics ‚Äì Medicaid Partnership",
                    text: "A local public health agency wants a partnership for Medicaid users. What do you do?",
                    choices: [
                        { text: "Offer steep discount", points: 10 },
                        { text: "Decline due to budget constraints", points: -5 }
                    ]
                },
                {
                    name: "AI Diagnostics ‚Äì Insurer Misuse",
                    text: "Insurers start using your AI to deny stroke treatment claims. What do you do?",
                    choices: [
                        { text: "Issue a public statement and audit misuse", points: 10 },
                        { text: "Stay silent to protect your stock price", points: -5 }
                    ]
                }
            ],
            gene: [
                {
                    name: "Gene Therapy ‚Äì Distribution Model",
                    text: "üèÅ Your lab develops a gene therapy for a rare disease with 90% success. What do you do?",
                    choices: [
                        { text: "Partner with a large pharmaceutical company", points: 5 },
                        { text: "Create a nonprofit distribution model", points: 10 }
                    ]
                },
                {
                    name: "Gene Therapy ‚Äì Pharma Pricing",
                    text: "The pharma company sets a $2 million price per dose. What do you do?",
                    choices: [
                        { text: "Challenge the pricing", points: 10 },
                        { text: "Support it for sustainability", points: -5 }
                    ]
                },
                {
                    name: "Gene Therapy ‚Äì Global Access",
                    text: "Countries in the Global South request access. What do you do?",
                    choices: [
                        { text: "License tech at reduced cost", points: 10 },
                        { text: "Limit use to paying markets", points: -5 }
                    ]
                },
                {
                    name: "Gene Therapy ‚Äì Lawsuit Over Access",
                    text: "Patients sue over being denied access due to cost. What do you do?",
                    choices: [
                        { text: "Set up an access fund", points: 10 },
                        { text: "Defend pricing strategy legally", points: -5 }
                    ]
                }
            ]
        };

        var pathConsequences = {
            genetic: [
                [
                    { type: 'mixed', text: 'Fast funding, but pressure for exclusive licensing.' },
                    { type: 'positive', text: 'Slower approval, but public access protected.' }
                ],
                [
                    { type: 'negative', text: 'Immediate profits, media backlash.' },
                    { type: 'positive', text: 'Delays, investor withdrawal, public trust boost.' }
                ],
                [
                    { type: 'mixed', text: 'Strong results, equity concerns.' },
                    { type: 'positive', text: 'Broader data, slower logistics.' }
                ],
                [
                    { type: 'negative', text: 'IPO ready, patients priced out.' },
                    { type: 'positive', text: 'Equity model praised, investor frustration.' }
                ]
            ],
            ai: [
                [
                    { type: 'positive', text: 'Scientific praise, no revenue.' },
                    { type: 'mixed', text: 'Fast profits, concern over access.' }
                ],
                [
                    { type: 'mixed', text: 'Company grows, media criticizes inequity.' },
                    { type: 'positive', text: 'Deal falls through, academic partnerships offered.' }
                ],
                [
                    { type: 'positive', text: 'Gains goodwill, stresses infrastructure.' },
                    { type: 'negative', text: 'Lost trust, protest from health advocates.' }
                ],
                [
                    { type: 'positive', text: 'Reputation improves, lawsuits emerge.' },
                    { type: 'negative', text: 'Short-term gains, whistleblower exposes decisions.' }
                ]
            ],
            gene: [
                [
                    { type: 'mixed', text: 'Fast production, profit pressure.' },
                    { type: 'positive', text: 'Transparent model, funding difficulty.' }
                ],
                [
                    { type: 'positive', text: 'Legal fights, media applause.' },
                    { type: 'negative', text: 'Stock price soars, ethical concerns grow.' }
                ],
                [
                    { type: 'positive', text: 'Equity accolades, profit tension.' },
                    { type: 'negative', text: 'Investor satisfaction, NGO criticism.' }
                ],
                [
                    { type: 'positive', text: 'Trust rebuilds, cost burdens rise.' },
                    { type: 'negative', text: 'Court loss damages reputation.' }
                ]
            ]
        };

        // Event listener to start game
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('start-btn').addEventListener('click', loadInitialChoice);
        });

        function loadInitialChoice() {
            document.getElementById('start-screen').classList.add('hidden');
            document.getElementById('game-screen').classList.remove('hidden');
            document.getElementById('current-step').textContent = '1';
            document.getElementById('scenario-name').textContent = 'Choose Your Scenario';
            document.getElementById('scenario-text').innerHTML = "üåü <strong>Choose your scenario to begin your 4-step bioethics journey:</strong>";
            
            var choicesHTML = '';
            choicesHTML += '<div class="choice"><button onclick="choosePath(\'genetic\')">üî¨ Genetic Test & Hospital Funding</button></div>';
            choicesHTML += '<div class="choice"><button onclick="choosePath(\'ai\')">üß† AI Diagnostics and Insurance</button></div>';
            choicesHTML += '<div class="choice"><button onclick="choosePath(\'gene\')">üß¨ Gene Therapy Pricing</button></div>';
            
            document.getElementById('choices').innerHTML = choicesHTML;
            document.getElementById('thinking').value = '';
            document.getElementById('consequence').style.display = 'none';
            document.getElementById('path-display').style.display = 'none';
            gameData = {
                currentStep: 1,
                score: 100,
                decisions: [],
                thoughts: [],
                chosenPath: null,
                pathName: ''
            };
            document.getElementById('score').textContent = '100';
        }

        function choosePath(path) {
            gameData.chosenPath = path;
            var scenarioLabels = {
                genetic: "Genetic Test & Hospital Funding",
                ai: "AI Diagnostics and Insurance",
                gene: "Gene Therapy Pricing"
            };
            gameData.pathName = scenarioLabels[path];

            // Record initial choice
            var choiceText = event.target.textContent;
            gameData.decisions.push({
                step: 1,
                choice: choiceText,
                points: 0,
                choiceIndex: -1
            });

            // Record thinking
            var thinking = document.getElementById('thinking').value.trim();
            if (thinking) {
                gameData.thoughts.push({
                    step: 1,
                    thought: thinking
                });
            }

            // Disable buttons
            var buttons = document.querySelectorAll('#choices button');
            for (var i = 0; i < buttons.length; i++) {
                buttons[i].disabled = true;
            }

            // Move to step 2
            setTimeout(function() {
                gameData.currentStep = 2;
                loadPathStep();
            }, 1200);
        }

        function loadPathStep() {
            var stepIndex = gameData.currentStep - 2; // 0-3 for steps 2-5
            var scenario = allScenarios[gameData.chosenPath][stepIndex];

            document.getElementById('current-step').textContent = gameData.currentStep;
            document.getElementById('scenario-name').textContent = scenario.name;
            document.getElementById('scenario-text').innerHTML = scenario.text;

            // Show path
            document.getElementById('path-display').style.display = 'block';
            document.getElementById('current-path').textContent = gameData.pathName;

            // Show consequence from previous step
            if (stepIndex > 0 && gameData.decisions.length > 0) {
                var lastDecision = gameData.decisions[gameData.decisions.length - 1];
                var consequence = pathConsequences[gameData.chosenPath][stepIndex - 1][lastDecision.choiceIndex];

                var conseqElement = document.getElementById('consequence');
                conseqElement.className = 'consequence ' + consequence.type;
                conseqElement.innerHTML = '<strong>Consequence of Your Previous Decision:</strong> ' + consequence.text;
                conseqElement.style.display = 'block';
            } else {
                document.getElementById('consequence').style.display = 'none';
            }

            // Load choices
            var choicesHTML = '';
            for (var i = 0; i < scenario.choices.length; i++) {
                choicesHTML += '<div class="choice"><button onclick="makeStepChoice(' + i + ')">' + scenario.choices[i].text + '</button></div>';
            }
            document.getElementById('choices').innerHTML = choicesHTML;

            document.getElementById('thinking').value = '';
        }

        function makeStepChoice(choiceIndex) {
            var stepIndex = gameData.currentStep - 2;
            var scenario = allScenarios[gameData.chosenPath][stepIndex];
            var choice = scenario.choices[choiceIndex];

            // Record thinking
            var thinking = document.getElementById('thinking').value.trim();
            if (thinking) {
                gameData.thoughts.push({
                    step: gameData.currentStep,
                    thought: thinking
                });
            }

            // Record decision
            gameData.decisions.push({
                step: gameData.currentStep,
                choice: choice.text,
                points: choice.points,
                choiceIndex: choiceIndex
            });

            // Update score
            gameData.score += choice.points;
            gameData.score = Math.max(0, Math.min(100, gameData.score));
            document.getElementById('score').textContent = gameData.score;

            // Disable buttons
            var buttons = document.querySelectorAll('#choices button');
            for (var i = 0; i < buttons.length; i++) {
                buttons[i].disabled = true;
            }

            // Move to next step or show results
            setTimeout(function() {
                if (gameData.currentStep < 5) {
                    gameData.currentStep++;
                    loadPathStep();
                } else {
                    showResults();
                }
            }, 1200);
        }

        function showResults() {
            document.getElementById('game-screen').classList.add('hidden');
            document.getElementById('results-screen').classList.remove('hidden');

            // Calculate assessment
            var assessment = '';
            if (gameData.score >= 36) {
                assessment = 'üåü <strong>Ethical Pioneer:</strong> You navigated the complex 4-step journey with exceptional ethical reasoning. Your decisions demonstrate sophisticated understanding of bioethics, stakeholder management, and long-term systemic thinking. Your approach could serve as a model for other healthcare leaders.';
            } else if (gameData.score >= 24) {
                assessment = '‚öñÔ∏è <strong>Thoughtful Navigator:</strong> You successfully handled most challenges, showing good ethical reasoning while balancing practical concerns. Some decisions could have been stronger, but overall you demonstrated solid bioethics leadership.';
            } else if (gameData.score >= 10) {
                assessment = 'üìö <strong>Learning Experience:</strong> Your journey revealed both strengths and areas for growth. Bioethics requires constant learning, and your experience highlights the importance of considering all stakeholders.';
            } else {
                assessment = 'üîÑ <strong>Reflection Opportunity:</strong> The journey was challenging, and your decisions show the difficulty of ethical leadership. Consider how different approaches might better balance ethical principles with practical outcomes.';
            }

            document.getElementById('final-score').textContent = gameData.score;
            document.getElementById('assessment').innerHTML = assessment;

            // Show decision summary
            var decisionHTML = '';
            for (var i = 1; i < gameData.decisions.length; i++) {
                var decision = gameData.decisions[i];
                decisionHTML += '<div style="margin: 10px 0; padding: 15px; background: #f8f9fa; border-radius: 5px; border-left: 4px solid #3498db;">';
                decisionHTML += '<strong>Step ' + decision.step + ':</strong> ' + decision.choice;
                if (decision.points !== undefined) {
                    decisionHTML += '<br><small>Ethics Impact: ' + (decision.points > 0 ? '+' : '') + decision.points + ' points</small>';
                }
                decisionHTML += '</div>';
            }
            document.getElementById('decision-summary').innerHTML = decisionHTML;

            // Show thinking summary
            var thinkingHTML = '';
            if (gameData.thoughts.length > 0) {
                for (var i = 0; i < gameData.thoughts.length; i++) {
                    var thought = gameData.thoughts[i];
                    thinkingHTML += '<div style="margin: 10px 0; padding: 15px; background: #f1f3f4; border-radius: 5px;">';
                    thinkingHTML += '<strong>Step ' + thought.step + ':</strong> ' + thought.thought;
                    thinkingHTML += '</div>';
                }
            } else {
                thinkingHTML = '<div style="font-style: italic; color: #666;">No reflections recorded during your journey.</div>';
            }
            document.getElementById('thinking-summary').innerHTML = thinkingHTML;
        }

        function restartGame() {
            document.getElementById('results-screen').classList.add('hidden');
            document.getElementById('start-screen').classList.remove('hidden');
        }
    </script>
</body>
</html>
